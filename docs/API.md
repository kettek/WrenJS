<!-- Generated by documentation.js. Update this documentation by updating the source code. -->

### Table of Contents

-   [WrenVM][1]
    -   [Parameters][2]
    -   [Examples][3]
    -   [interpret][4]
        -   [Parameters][5]
        -   [Examples][6]
    -   [call][7]
        -   [Parameters][8]
        -   [Examples][9]
    -   [free][10]
    -   [addForeignMethod][11]
        -   [Parameters][12]
        -   [Examples][13]
    -   [addForeignClassMethods][14]
        -   [Parameters][15]
        -   [Examples][16]
    -   [ensureSlots][17]
        -   [Parameters][18]
    -   [getSlotCount][19]
    -   [getSlotType][20]
        -   [Parameters][21]
    -   [getSlotDouble][22]
        -   [Parameters][23]
    -   [setSlotDouble][24]
        -   [Parameters][25]
    -   [getSlotString][26]
        -   [Parameters][27]
    -   [setSlotString][28]
        -   [Parameters][29]
    -   [getSlotBytes][30]
        -   [Parameters][31]
    -   [setSlotBytes][32]
        -   [Parameters][33]
    -   [getSlotBool][34]
        -   [Parameters][35]
    -   [setSlotBool][36]
        -   [Parameters][37]
    -   [setSlotNull][38]
        -   [Parameters][39]
    -   [getSlotForeign][40]
        -   [Parameters][41]
    -   [setSlotNewForeign][42]
        -   [Parameters][43]
    -   [setSlotNewList][44]
        -   [Parameters][45]
    -   [getListCount][46]
        -   [Parameters][47]
    -   [getListElement][48]
        -   [Parameters][49]
    -   [insertInList][50]
        -   [Parameters][51]
    -   [getVariable][52]
        -   [Parameters][53]
    -   [getSlotHandle][54]
        -   [Parameters][55]
    -   [setSlotHandle][56]
        -   [Parameters][57]
    -   [makeCallHandle][58]
        -   [Parameters][59]
        -   [Examples][60]
    -   [releaseHandle][61]
        -   [Parameters][62]
    -   [collectGarbage][63]
    -   [abortFiber][64]
        -   [Parameters][65]
    -   [importFile][66]
        -   [Parameters][67]
        -   [Examples][68]
    -   [importFiles][69]
        -   [Parameters][70]
        -   [Examples][71]
-   [WrenJS][72]
    -   [newVM][73]
        -   [Parameters][74]
    -   [WrenInterpretResult][75]
        -   [Properties][76]
    -   [WrenType][77]
        -   [Properties][78]
    -   [WrenErrorType][79]
        -   [Properties][80]
-   [LibraryWren][81]
    -   [WrenJS_errorFn][82]
        -   [Parameters][83]
    -   [WrenJS_writeFn][84]
        -   [Parameters][85]
    -   [WrenJS_getForeignMethod][86]
        -   [Parameters][87]
    -   [WrenJS_getForeignClassAllocator][88]
        -   [Parameters][89]
    -   [WrenJS_getForeignClassFinalizer][90]
        -   [Parameters][91]
    -   [WrenJS_isFileAvailable][92]
        -   [Parameters][93]
    -   [WrenJS_importFileFromVM][94]
        -   [Parameters][95]

## WrenVM

WrenVM provides an object-oriented interface to the underlying Wren VM.

### Parameters

-   `id` **[number][96]** This is the emscripten numerical pointer to a WrenVM instance.
-   `config` **[object][97]** This optional object can provide a writeFn(string) or an errorFn(type, module, line, message) handler.

### Examples

```javascript
WrenJS.addEventListener('ready', () => {
  var vm = WrenJS.newVM({
    writeFn: (text) => {
      console.log("stdout: %s", text)
    },
    errorFn: (type, module, line, message) => {
      console.log("stderr(%d): %s %d %s", type, module, line, message)
    }
  })
  vm.interpret("main", 'System.print("Hello, xorld!")')
  .then(result => {
    switch(result) {
      case WrenJS.RESULT_COMPILE_ERROR:
        console.log("Compilation error!")
        break
      case WrenJS.RESULT_RUNTIME_ERROR:
        console.log("Runtime error!")
        break
      case WrenJS.RESULT_SUCCESS:
        console.log("Success!")
        break
    }
    // vm.call(...), etc.
    vm.free()
  })
})
```

### interpret

Runs the VM interpreter in the given module space with the provided source.

#### Parameters

-   `module` **[string][98]** 
-   `source` **[string][98]** 

#### Examples

```javascript
vm.interpret('main', 'System.print("Hello, xorld!")').then(result => {
  // Handle result.
})
```

Returns **[Promise][99]** 

### call

Calls the given handle. This presumes Wren slots have been set up appropriately.

#### Parameters

-   `handle` **[number][96]** 

#### Examples

```javascript
vm.ensureSlots(2)
vm.getVariable("my_module", "myClass", 0)
var handle = vm.makeCallHandle("classMethod()")
vm.call(handle)
vm.releaseHandle(handle)
```

### free

Frees up the VM. You must call `releaseHandle` on all your handles first.

### addForeignMethod

Adds a foreign method to the VM.

#### Parameters

-   `module` **[string][98]** 
-   `className` **[string][98]** 
-   `isStatic` **bool** 
-   `signature` **[string][98]** 
-   `cb` **[function][100]** 

#### Examples

```javascript
vm.addForeignMethod("wren/ForeignClass", "ForeignClass", 0, "add(_,_)", function() {
  var a = vm.getSlotDouble(1)
  var b = vm.getSlotDouble(2)
  vm.setSlotDouble(0, a+b)
})
```

### addForeignClassMethods

Adds a foreign class allocator and finalizer.

#### Parameters

-   `module` **[string][98]** 
-   `className` **[string][98]** 
-   `allocator` **[function][100]** 
-   `finalizer` **[function][100]** 

#### Examples

```javascript
vm.addForeignClassMethods("wren/ForeignClass", "ForeignClass", function() {
  // Allocator
  vm.setSlotNewForeign(0, 0, 0)
}, function() {
  // Finalizer
})
```

### ensureSlots

Ensures that the VM has the defined amount of slots available for use.

#### Parameters

-   `count` **[number][96]** 

### getSlotCount

Gets the amount of slots currently used.

Returns **[number][96]** 

### getSlotType

Returns the WrenType stored in a given slot.

#### Parameters

-   `slot` **[number][96]** 

Returns **[number][96]** 

### getSlotDouble

Returns a floating point number stored in a given slot.

#### Parameters

-   `slot` **[number][96]** 

Returns **[number][96]** 

### setSlotDouble

Sets the given slot to the provided floating point number.

#### Parameters

-   `slot` **[number][96]** 
-   `value` **[number][96]** 

### getSlotString

Returns a string stored in the given slot.

#### Parameters

-   `slot` **[number][96]** 

Returns **[string][98]** 

### setSlotString

Sets the given slot to the provided string.

#### Parameters

-   `slot` **[number][96]** 
-   `string` **[string][98]** 

### getSlotBytes

Returns a Uint8Array of bytes stored in the given slot.

#### Parameters

-   `slot` **[number][96]** 

Returns **[Uint8Array][101]** 

### setSlotBytes

Sets the given slot to the provided TypedArray. Provided data will be converted to a Uint8Array.

#### Parameters

-   `slot` **[number][96]** 
-   `typedArray` **[TypedArray][102]** 

### getSlotBool

Returns the boolean value of a given slot.

#### Parameters

-   `slot` **[number][96]** 

Returns **[boolean][103]** 

### setSlotBool

Sets the given slot to the provided boolean value.

#### Parameters

-   `slot` **[number][96]** 
-   `value` **[boolean][103]** 

### setSlotNull

Sets the given slot to null.

#### Parameters

-   `slot` **[number][96]** 

### getSlotForeign

Returns a foreign object from the provided slot.

#### Parameters

-   `slot` **[number][96]** 

Returns **[number][96]** 

### setSlotNewForeign

Sets the given slot to a new foreign object with an optional size for extra bytes storage.

#### Parameters

-   `slot` **[number][96]** 
-   `classSlot` **[number][96]** 
-   `size` **[number][96]** 

Returns **[number][96]** pointer to the extra bytes.

### setSlotNewList

Sets the given slot to a new list.

#### Parameters

-   `slot` **[number][96]** 

### getListCount

Returns the number of items in a list in the given slot.

#### Parameters

-   `slot` **[number][96]** 

Returns **[number][96]** 

### getListElement

Moves an element from the given listSlot's index to target elementSlot.

#### Parameters

-   `listSlot` **[number][96]** 
-   `index` **[number][96]** 
-   `elementSlot` **[number][96]** 

### insertInList

Inserts the provided element in elementSlot into the index position in the list at slot.

#### Parameters

-   `slot` **[number][96]** 
-   `index` **[number][96]** 
-   `elementSlot` **[number][96]** 

### getVariable

Gets a variable of the provided name in a module and sets it to the given slot.

#### Parameters

-   `module` **[string][98]** 
-   `name` **[string][98]** 
-   `slot` **[number][96]** 

### getSlotHandle

Returns the handle in the given slot.

#### Parameters

-   `slot` **[number][96]** 

Returns **[number][96]** 

### setSlotHandle

Sets the given slot to the given handle.

#### Parameters

-   `slot` **[number][96]** 
-   `handle` **[number][96]** 

### makeCallHandle

Creates and returns a handle that is usable in functions such as `call(handle)`.
You must call `releaseHandle(handle)` before you free the VM.

#### Parameters

-   `signature` **[string][98]** 

#### Examples

```javascript
vm.ensureSlots(2)
vm.getVariable("my_module", "myClass", 0)
var handle = vm.makeCallHandle("foreignMethod()")
vm.call(handle)
vm.releaseHandle(handle)
```

Returns **[number][96]** 

### releaseHandle

Release the given handle from the VM.

#### Parameters

-   `handle` **[number][96]** 

### collectGarbage

Calls the VM's garbage collection routine.

### abortFiber

Aborts the fiber.

#### Parameters

-   `slot` **[number][96]** 

### importFile

Loads a given file via XHR and adds it to the importedFiles map.
Must be called before interpreting.
Does nothing if WrenJS+ was built with DISABLE_JSVM_IMPORT.

#### Parameters

-   `file` **[string][98]** 

#### Examples

```javascript
vm.importFile("wren/testImport.wren")
.then(result => {
  vm.interpret(...)
})
```

Returns **[Promise][99]** 

### importFiles

Calls importFile(...) on an array of strings.

#### Parameters

-   `files` **[Array][104]&lt;[string][98]>** 

#### Examples

```javascript
vm.importFiles(["wren/testImport.wren", "wren/testImport2.wren"])
.then(result => {
  vm.interpret(...)
})
```

Returns **[Promise][99]** 

## WrenJS

WrenJS is the interface through which Wren VMs are created. Be aware that this is actually an Emscripten Module.
See [preamble.js][105] for additional information.

### newVM

Creates and returns a new WrenVM instance.

#### Parameters

-   `config` **[object][97]** Provides a config object that can contain errorFn and/or writeFn.

Returns **[WrenVM][106]** 

### WrenInterpretResult

WrenInterpretResult is the resulting value of a call to WrenVM.interpret.

Type: [number][96]

#### Properties

-   `RESULT_COMPILE_ERROR` **[number][96]?** Compilation error.
-   `RESULT_RUNTIME_ERROR` **[number][96]?** Runtime error.
-   `RESULT_SUCCESS` **[number][96]?** Success.

### WrenType

WrenType represents a WrenVM data type.

Type: [number][96]

#### Properties

-   `TYPE_BOOL` **[number][96]?** Boolean type.
-   `TYPE_NUM` **[number][96]?** Numerical type.
-   `TYPE_STRING` **[number][96]?** String type.
-   `TYPE_LIST` **[number][96]?** List type.
-   `TYPE_FOREIGN` **[number][96]?** Foreign object type.
-   `TYPE_NULL` **[number][96]?** Null type.
-   `TYPE_UNKNOWN` **[number][96]?** Unknown type.

### WrenErrorType

WrenErrorType represents a given error type that will be passed to
WrenVM.errorFn.

Type: [number][96]

#### Properties

-   `ERROR_COMPILE` **[number][96]?** Compile-time error.
-   `ERROR_RUNTIME` **[number][96]?** Run-time error.
-   `ERROR_STACK_TRACE` **[number][96]?** Stack-trace for a given error.

## LibraryWren

LibraryWren provides the JavaScript functions available to C.

### WrenJS_errorFn

Provides the C to WrenJS to WrenVM interface for handling Wren's error function.

#### Parameters

-   `id` **[number][96]** 
-   `type` **[number][96]** 
-   `module` **[string][98]** 
-   `line` **[number][96]** 
-   `message` **[string][98]** 

### WrenJS_writeFn

Provides the C to WrenJS to WrenVM interface for handling Wren's write function.

#### Parameters

-   `id` **[number][96]** 
-   `text` **[string][98]** 

### WrenJS_getForeignMethod

Returns a VM's foreign method to C.

#### Parameters

-   `id` **[number][96]** 
-   `module` **[string][98]** 
-   `className` **[string][98]** 
-   `isStatic` **[boolean][103]** 
-   `signature` **[string][98]** 

Returns **[function][100]** 

### WrenJS_getForeignClassAllocator

Returns a VM's foreign class allocator to C.

#### Parameters

-   `id` **[number][96]** 
-   `module` **[string][98]** 
-   `className` **[string][98]** 

Returns **[function][100]** 

### WrenJS_getForeignClassFinalizer

Returns a VM's foreign class finalizer(destructor) to C.

#### Parameters

-   `id` **[number][96]** 
-   `module` **[string][98]** 
-   `className` **[string][98]** 

Returns **[function][100]** 

### WrenJS_isFileAvailable

Returns whether or not a file has been defined as a wren script in the document's head.
This is not used if WrenJS+ was built with ALLOW_NONSCRIPT_FETCH.

#### Parameters

-   `file` **[string][98]** 

Returns **[boolean][103]** 

### WrenJS_importFileFromVM

Requests a VM-defined result for a Wren import statement.
This is not used if WrenJS+ was built with DISABLE_JSVM_IMPORT.

#### Parameters

-   `vm` **[number][96]** 
-   `file` **[string][98]** 
-   `return_string` **[number][96]** 
-   `return_bytes` **[number][96]** 

[1]: #wrenvm

[2]: #parameters

[3]: #examples

[4]: #interpret

[5]: #parameters-1

[6]: #examples-1

[7]: #call

[8]: #parameters-2

[9]: #examples-2

[10]: #free

[11]: #addforeignmethod

[12]: #parameters-3

[13]: #examples-3

[14]: #addforeignclassmethods

[15]: #parameters-4

[16]: #examples-4

[17]: #ensureslots

[18]: #parameters-5

[19]: #getslotcount

[20]: #getslottype

[21]: #parameters-6

[22]: #getslotdouble

[23]: #parameters-7

[24]: #setslotdouble

[25]: #parameters-8

[26]: #getslotstring

[27]: #parameters-9

[28]: #setslotstring

[29]: #parameters-10

[30]: #getslotbytes

[31]: #parameters-11

[32]: #setslotbytes

[33]: #parameters-12

[34]: #getslotbool

[35]: #parameters-13

[36]: #setslotbool

[37]: #parameters-14

[38]: #setslotnull

[39]: #parameters-15

[40]: #getslotforeign

[41]: #parameters-16

[42]: #setslotnewforeign

[43]: #parameters-17

[44]: #setslotnewlist

[45]: #parameters-18

[46]: #getlistcount

[47]: #parameters-19

[48]: #getlistelement

[49]: #parameters-20

[50]: #insertinlist

[51]: #parameters-21

[52]: #getvariable

[53]: #parameters-22

[54]: #getslothandle

[55]: #parameters-23

[56]: #setslothandle

[57]: #parameters-24

[58]: #makecallhandle

[59]: #parameters-25

[60]: #examples-5

[61]: #releasehandle

[62]: #parameters-26

[63]: #collectgarbage

[64]: #abortfiber

[65]: #parameters-27

[66]: #importfile

[67]: #parameters-28

[68]: #examples-6

[69]: #importfiles

[70]: #parameters-29

[71]: #examples-7

[72]: #wrenjs

[73]: #newvm

[74]: #parameters-30

[75]: #wreninterpretresult

[76]: #properties

[77]: #wrentype

[78]: #properties-1

[79]: #wrenerrortype

[80]: #properties-2

[81]: #librarywren

[82]: #wrenjs_errorfn

[83]: #parameters-31

[84]: #wrenjs_writefn

[85]: #parameters-32

[86]: #wrenjs_getforeignmethod

[87]: #parameters-33

[88]: #wrenjs_getforeignclassallocator

[89]: #parameters-34

[90]: #wrenjs_getforeignclassfinalizer

[91]: #parameters-35

[92]: #wrenjs_isfileavailable

[93]: #parameters-36

[94]: #wrenjs_importfilefromvm

[95]: #parameters-37

[96]: https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Number

[97]: https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Object

[98]: https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String

[99]: https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Promise

[100]: https://developer.mozilla.org/docs/Web/JavaScript/Reference/Statements/function

[101]: https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Uint8Array

[102]: https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/TypedArray

[103]: https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Boolean

[104]: https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Array

[105]: https://emscripten.org/docs/api_reference/preamble.js.html

[106]: #wrenvm
